<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:transparent;
}

.container{
  border-left:6px solid #2e7d32;
  padding:15px;
}

select,button{
  padding:8px;
  margin:5px 3px;
  border-radius:6px;
  border:1px solid #ccc;
  font-weight:bold;
}

button{
  background:#2e7d32;
  color:white;
  cursor:pointer;
}

button:hover{
  opacity:0.9;
}

.leitura{
  margin-top:15px;
}

.dia{
  padding:6px 0;
  border-bottom:1px solid #eee;
}

.hoje{
  font-weight:bold;
  color:#2e7d32;
}

.recomendado{
  font-weight:bold;
}
</style>
</head>

<body>

<div class="container">

<select id="temporada"></select>
<select id="semana"></select>

<button onclick="aplicar()">üìñ Aplicar</button>
<button onclick="irHoje()">‚≠ê HOJE</button>

<div class="leitura" id="resultado"></div>

</div>

<script>

let plano={};

fetch("leitura-biblica-perpetuo.json")
.then(r=>r.json())
.then(data=>{
    plano=data;
    carregarTemporadas();
});

function carregarTemporadas(){
    const t=document.getElementById("temporada");
    t.innerHTML="";

    Object.keys(plano).forEach(temp=>{
        let op=document.createElement("option");
        op.value=temp;
        op.text=temp.toUpperCase()+" ‚≠ê";
        t.appendChild(op);
    });

    carregarSemanas();
}

function carregarSemanas(){
    const temp=document.getElementById("temporada").value;
    const s=document.getElementById("semana");

    s.innerHTML="";

    plano[temp].forEach((sem,i)=>{
        let op=document.createElement("option");
        op.value=i;
        op.text=sem.semana;
        s.appendChild(op);
    });
}

document.getElementById("temporada")
.addEventListener("change",carregarSemanas);

function aplicar(){

    const temp=document.getElementById("temporada").value;
    const semanaIndex=document.getElementById("semana").value;

    const semana=plano[temp][semanaIndex];

    let html=`<div class="recomendado">üìñ ${semana.semana}</div>`;
    html+=`<div><b>${semana.versiculo}</b></div><br>`;

    Object.entries(semana.dias).forEach(([data,leitura])=>{
        html+=`<div class="dia"><b>${data}</b> ‚Äî ${leitura}</div>`;
    });

    document.getElementById("resultado").innerHTML=html;
}

function irHoje(){

    const hoje=new Date();
    const mes=String(hoje.getMonth()+1).padStart(2,'0');
    const dia=String(hoje.getDate()).padStart(2,'0');

    const hojeStr=`${mes}-${dia}`;

    for(const temp in plano){

        plano[temp].forEach((sem,i)=>{

            if(sem.dias[hojeStr]){

                document.getElementById("temporada").value=temp;
                carregarSemanas();
                document.getElementById("semana").value=i;

                aplicar();

                destacarHoje(hojeStr);
            }

        });

    }
}

function destacarHoje(dataHoje){

    document.querySelectorAll(".dia")
    .forEach(el=>{
        if(el.innerText.startsWith(dataHoje)){
            el.classList.add("hoje");
        }
    });

}

</script>

</body>
</html>